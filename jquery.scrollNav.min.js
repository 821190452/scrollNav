(function(e){e.fn.scrollNav=function(t){e("body").addClass("sn-loading");var n={sections:"h2",subSections:!1,showHeadline:!0,headlineText:"Scroll To",showTopLink:!0,topLinkText:"Top",fixedMargin:40,animated:!0,speed:500,location:"insertBefore"};e.extend(n,t);var r=[],i=this,s=i.find(n.sections),o=e("<span />",{"class":"scroll-nav__heading",text:n.headlineText}),u=e("<nav />",{"class":"scroll-nav",role:"navigation"});u=n.showHeadline===!0?u.append(o):u;var a=function(){var t=i.offset().top,o=[],u=i.children().first().nextUntil(s).andSelf();if(n.subSections){var a=u.filter(n.subSections);a.each(function(t){var n="scrollNav-0-"+(t+1),r=e(this).offset().top,i=e(this).text();e(this).attr("id",n);o.push({id:n,offset:r,text:i})})}u.wrapAll('<section id="scrollNav-0" />');n.showTopLink!==!1&&r.push({id:"scrollNav-0",offset:t,text:n.topLinkText,subSections:o})},f=function(){s.each(function(t){var i=[],o="scrollNav-"+(t+1),u=e(this).offset().top,a=e(this).text(),f=e(this).nextUntil(s).andSelf();if(n.subSections){var l=f.filter(n.subSections);l.each(function(t){var n=o+"-"+(t+1),r=e(this).offset().top,s=e(this).text(),u=e(this).nextUntil(l).andSelf();console.log(u);e(this).attr("id",n);i.push({id:n,offset:r,text:s})})}f.wrapAll('<section id="'+o+'" />');r.push({id:o,offset:u,text:a,subSections:i})})},l=function(){var t=e("<ol />",{"class":"scroll-nav__list"}),i;e.each(r,function(n){var r=n===0?e("<li />",{"class":"scroll-nav__item active"}):e("<li />",{"class":"scroll-nav__item"}),s=e("<a />",{href:"#"+this.id,"class":"scroll-nav__link",text:this.text});if(this.subSections.length>0){i=e("<ol />",{"class":"scroll-nav__sub-list"});e.each(this.subSections,function(){var t=e("<li />",{"class":"scroll-nav__sub-item"}),n=e("<a />",{href:"#"+this.id,"class":"scroll-nav__sub-link",text:this.text});i.append(t.append(n))})}t.append(r.append(s).append(i))});n.showHeadline===!0?u.append(o).append(t):u.append(t)},c=function(){var t=u.offset().top;e(window).resize(function(){e.each(r,function(){this.offset=e("#"+this.id).offset().top})});e(window).scroll(function(){var i=e(window).scrollTop(),s=e(window).height()*.5;i>t-n.fixedMargin?u.addClass("fixed"):u.removeClass("fixed");e.each(r,function(){if(this.offset>i-n.fixedMargin&&this.offset<i+s){u.find("li").removeClass("active");u.find('a[href="#'+this.id+'"]').parents("li").addClass("active")}})})};if(i.length>0){a();f();l()}i.length>0&&s.length>0?u[n.location](i):i.length===0?console.log('Build failed, scrollNav could not find "'+i.selector+'"'):s.length===0&&console.log('Build failed, scrollNav could not find any "'+n.sections+"'s inside of \""+i.selector+'"');c();n.animated===!0&&e(".scroll-nav").find("a").click(function(){var t=e(this).attr("href"),r=e(t).offset().top;e("html:not(:animated),body:not(:animated)").animate({scrollTop:r-40},n.speed);return!1});e("body").removeClass("sn-loading").addClass("sn-active")}})(jQuery);