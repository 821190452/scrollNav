(function(e){e.fn.scrollNav=function(t){e("body").addClass("sn-loading");var n={sections:"h2",subSections:!1,showHeadline:!0,headlineText:"Scroll To",showTopLink:!0,topLinkText:"Top",animated:!0,fixedMargin:40,scrollOffset:40,speed:500,location:"insertBefore"};e.extend(n,t);var r=[],i=this,s=i.find(n.sections),o=e("<span />",{"class":"scroll-nav__heading",text:n.headlineText}),u=e("<nav />",{"class":"scroll-nav",role:"navigation"});u=n.showHeadline?u.append(o):u;var a,f,l=function(){var t=[],o="scrollNav-0",u=i.children().first().nextUntil(s).andSelf();if(n.subSections){var a=u.filter(n.subSections);if(a.length>0){a.each(function(n){var r=o+"-"+(n+1),i=e(this).text(),s=u.filter(e(this).nextUntil(a).andSelf());s.wrapAll('<div id="'+r+'" class="scroll-nav__sub-section" />');t.push({id:r,text:i})});u=e(this).nextUntil(s).andSelf()}}u.wrapAll('<section id="'+o+'" />');n.showTopLink&&r.push({id:"scrollNav-0",text:n.topLinkText,subSections:t})},c=function(){s.each(function(t){var i=[],o="scrollNav-"+(t+1),u=e(this).text(),a=e(this).nextUntil(s).andSelf();if(n.subSections){var f=a.filter(n.subSections);if(f.length>0){f.each(function(t){var n=o+"-"+(t+1),r=e(this).text(),s=a.filter(e(this).nextUntil(f).andSelf());s.wrapAll('<div id="'+n+'" class="scroll-nav__sub-section" />');i.push({id:n,text:r})});a=e(this).nextUntil(s).andSelf()}}a.wrapAll('<section id="'+o+'" />');r.push({id:o,text:u,subSections:i})})},h=function(){var t=e("<ol />",{"class":"scroll-nav__list"});e.each(r,function(n){var r=n===0?e("<li />",{"class":"scroll-nav__item active"}):e("<li />",{"class":"scroll-nav__item"}),i=e("<a />",{href:"#"+this.id,"class":"scroll-nav__link",text:this.text}),s;if(this.subSections.length>0){r.addClass("is-parent-item");s=e("<ol />",{"class":"scroll-nav__sub-list"});e.each(this.subSections,function(){var t=e("<li />",{"class":"scroll-nav__sub-item"}),n=e("<a />",{href:"#"+this.id,"class":"scroll-nav__sub-link",text:this.text});s.append(t.append(n))})}t.append(r.append(i).append(s))});n.showHeadline===!0?u.append(o).append(t):u.append(t)},p=function(){a=e(window).height();f=u.offset().top;e.each(r,function(){this.topOffset=e("#"+this.id).offset().top;this.bottomOffset=this.topOffset+e("#"+this.id).height()})},d=function(){var t=e(window).scrollTop(),i=t+n.scrollOffset,s=t+a-n.scrollOffset,o=[];t>f-n.fixedMargin?u.addClass("fixed"):u.removeClass("fixed");e.each(r,function(){(this.topOffset>i&&this.topOffset<s||this.bottomOffset>i&&this.bottomOffset<s||this.topOffset<i&&this.bottomOffset>s)&&o.push(this)});u.find(".scroll-nav__item").removeClass("active");e.each(o,function(){u.find('a[href="#'+this.id+'"]').parents(".scroll-nav__item").addClass("active")})},v=function(){e(window).resize(function(){p()});e(window).scroll(function(){d()})};if(i.length>0){l();c();h()}if(i.length>0&&s.length>0){u[n.location](i);p();d()}else i.length===0?console.log('Build failed, scrollNav could not find "'+i.selector+'"'):s.length===0&&console.log('Build failed, scrollNav could not find any "'+n.sections+"'s inside of \""+i.selector+'"');v();n.animated&&e(".scroll-nav").find("a").on("click",function(t){t.preventDefault();var r=e(this).attr("href"),i=e(r).offset().top;e("html:not(:animated),body:not(:animated)").animate({scrollTop:i-n.scrollOffset},n.speed)});e("body").removeClass("sn-loading").addClass("sn-active")}})(jQuery);